document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".threed_buttons");if(e){const o=e.dataset.modelid,t=btoa(o.toString());fetch("https://ncr.preqservices.com/ajax/models/get-models.php?action=checkstatus&modelid="+t).then((e=>e.json())).then((o=>{"Active"===o.status?e.style.display="block":e.style.display="none"})).catch((e=>{console.error("Error fetching model status:",e)}))}const o=document.createElement("style");o.textContent=" .btn{background-color:#007bff;color:#fff;padding:10px 20px;border:none;border-radius:5px;font-size:16px;cursor:pointer}.btn:hover{background-color:#0056b3}.custom-modal{display:none;position:fixed;z-index:9999;inset:0;background-color:rgb(0 0 0 / .6);justify-content:center;align-items:center}.modal-box{background:#fff;width:80%;max-width:1000px;border-radius:12px;overflow:hidden;display:flex;flex-direction:column}.modal-header{display:flex;justify-content:flex-end;padding:10px}.close-btn{font-size:28px;cursor:pointer;border:none;background:none}model-viewer{width:100%;height:500px}.model-id{text-align:center;padding:10px 0;font-weight:700;font-size:16px;color:#007bff}.modal-footer{display:flex;justify-content:space-around;padding:10px;border-top:1px solid #ccc;background-color:#f9f9f9;font-size:14px}.footer-icon{text-align:center;color:#333;cursor:pointer}.footer-icon span{display:block;font-size:12px;margin-top:4px}",document.head.appendChild(o);const t=document.createElement("script");t.type="module",t.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(t);const n=document.createElement("div");n.className="custom-modal",n.style.display="none",n.innerHTML='\n        <div class="modal-box">\n            <div class="modal-header">\n                <button class="close-btn" title="Close">&times;</button>\n            </div>\n            <model-viewer id="viewer3D" src="" alt="3D model" camera-controls auto-rotate ar></model-viewer>\n            <div class="model-id" id="modelIdText">MODEL-ID</div>\n            <div class="modal-footer">\n                <div class="footer-icon"><img src="https://img.icons8.com/ios-filled/24/share.png"/><span>Share</span></div>\n                <div class="footer-icon"><img src="https://img.icons8.com/ios-filled/24/settings.png"/><span>Settings</span></div>\n                <div class="footer-icon"><img src="https://img.icons8.com/ios-filled/24/camera.png"/><span>View in AR</span></div>\n            </div>\n        </div>\n    ',document.body.appendChild(n);const s=n.querySelector("#viewer3D"),i=n.querySelector(".close-btn"),d=n.querySelector("#modelIdText");document.addEventListener("click",(e=>{const o=e.target.closest(".threed_buttons[data-modelid]");if(o){const e=o.dataset.modelid,t=o.dataset.modeltype,i=navigator.platform.toLowerCase(),r=window.location.hostname,l=r+e,c=btoa(r.toString()),a=btoa(e.toString()),p=navigator.userAgent;console.log("platform",i),console.log("domain",r),console.log("genKey",l),console.log("clientAccessKey",c),n.style.display="flex",d.textContent=e,s.src="",fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((e=>{fetch(`https://ncr.preqservices.com/ajax/models/get-models.php?action=getfile&platform=${i}&domain=${r}&modelid=${a}&ip=${e.ip}&useragent=${p}&filetype=${t}`).then((e=>e.json())).then((e=>{"Ok"===e.status&&e.file_url?(s.src=e.file_url,console.log("Model loaded:",e.file_url)):console.warn("Model inactive or no file")})).catch((e=>{console.error("Error fetching 3D model:",e)}))})).catch((e=>{console.error("Error getting IP address:",e)}))}e.target!==n&&e.target!==i||(n.style.display="none",s.src="")}))}));
